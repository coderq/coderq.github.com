<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CoderQ·博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="CoderQ·博客">
<meta property="og:url" content="http://coderq.github.io/page/4/index.html">
<meta property="og:site_name" content="CoderQ·博客">
<meta property="og:description" content="个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CoderQ·博客">
<meta name="twitter:description" content="个人博客">
  
    <link rel="alternative" href="/atom.xml" title="CoderQ·博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
      <style> .article { opacity: 0;} </style>
  
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  
  <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false,
      }
  </script>

  
      <script>
          yiliaConfig.rootUrl = "/";
      </script>
  

  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="http://7xqex1.com1.z0.glb.clouddn.com/avatar%2F1426483393_DXGAJIiR.jpeg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">CoderQ</a></h1>
        </hgroup>

        
        <p class="header-subtitle">不积硅步无以至千里(旧博客地址：http://blog.coderq.net)</p>
        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:623619038@qq.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/coderq" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/C/" style="font-size: 12.5px;">C</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/eslint/" style="font-size: 10px;">eslint</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/highlight/" style="font-size: 10px;">highlight</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/http-server/" style="font-size: 10px;">http-server</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/mac/" style="font-size: 12.5px;">mac</a> <a href="/tags/mongodb/" style="font-size: 17.5px;">mongodb</a> <a href="/tags/mongoose/" style="font-size: 10px;">mongoose</a> <a href="/tags/mosh/" style="font-size: 10px;">mosh</a> <a href="/tags/msgpack/" style="font-size: 10px;">msgpack</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/opencv/" style="font-size: 10px;">opencv</a> <a href="/tags/orientdb/" style="font-size: 12.5px;">orientdb</a> <a href="/tags/pm2/" style="font-size: 10px;">pm2</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/ssl/" style="font-size: 10px;">ssl</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/微信/" style="font-size: 10px;">微信</a> <a href="/tags/数学/" style="font-size: 10px;">数学</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/状态码/" style="font-size: 10px;">状态码</a> <a href="/tags/算法/" style="font-size: 12.5px;">算法</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">CoderQ</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="http://7xqex1.com1.z0.glb.clouddn.com/avatar%2F1426483393_DXGAJIiR.jpeg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">CoderQ</a></h1>
            </hgroup>
            
            <p class="header-subtitle">不积硅步无以至千里(旧博客地址：http://blog.coderq.net)</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:623619038@qq.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/coderq" title="GitHub"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-nginx-config" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/03/nginx-config/" class="article-date">
      <time datetime="2016-03-03T00:41:07.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/nginx-config/">nginx配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u5168_u5C40_u914D_u7F6E"><a href="#u5168_u5C40_u914D_u7F6E" class="headerlink" title="全局配置"></a>全局配置</h2><h3 id="user"><a href="#user" class="headerlink" title="user"></a>user</h3><p>用于指定nginx进程运行用户以及用户组，默认情况下将使用与用户名相同的组，除非编译时指定–user=USER和–group=GROUP</p>
<h3 id="worker_processes"><a href="#worker_processes" class="headerlink" title="worker_processes"></a>worker_processes</h3><p>用于指定nginx的进程数，一般设置为与CPU核数一致即可。</p>
<h3 id="error_log"><a href="#error_log" class="headerlink" title="error_log"></a>error_log</h3><p>用于指定全局错误日志文件，日志错误级别包括debug,info,notice,warn,error,crit，日志的信息量由debug到crit递减。</p>
<p>nginx支持为每个虚拟主机配置不同的日志文件，如果在编译安装的时候加入–with-debug参数，可以使用以下配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_log LOGFILE [debug_core | debug_alloc | debug_mutex | debug_event | debug_http | debug_imap];</span><br></pre></td></tr></table></figure></p>
<p><strong>error_log off</strong>并不能关闭日志记录，而会将日志文件写入另一个文件名为off的文件中，如果你想关闭错误日志功能 ，应使用以下配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_log  /dev/null crit;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#user  nobody;&#10;worker_processes  auto;&#10;&#10;#error_log  logs/error.log;&#10;#error_log  logs/error.log  notice;&#10;#error_log  logs/error.log  info;&#10;&#10;#pid        logs/nginx.pid;&#10;&#10;events &#123;&#10;    worker_connections  1024;&#10;    multi_accept on;&#10;&#125;&#10;&#10;http &#123;&#10;    include       mime.types;&#10;    default_type  application/octet-stream;&#10;&#10;    server_tokens   off;&#10;    sendfile        on;&#10;    tcp_nopush      on;&#10;    tcp_nodelay     on;&#10;&#10;    keepalive_timeout  65;&#10;    &#10;    server &#123;&#10;        listen 80;&#10;        server_name local.tms.shenba.com;&#10;&#10;        location / &#123;&#10;            proxy_set_header Host $host;&#10;            proxy_set_header X-Real-IP $remote_addr;&#10;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&#10;            proxy_buffering off;&#10;            proxy_pass           http://localhost:3445;&#10;        &#125;&#10;&#10;        &#10;    &#125;&#10;&#10;    server &#123;&#10;        listen 80;&#10;        server_name local.h5.shenba.com;&#10;&#10;        location / &#123;&#10;            proxy_set_header Host $host;&#10;            proxy_set_header X-Real-IP $remote_addr;&#10;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&#10;            proxy_buffering off;&#10;            proxy_pass           http://localhost:3446;&#10;        &#125;&#10;    &#125;&#10;&#10;    server &#123;&#10;        listen 80;&#10;        server_name local.h5statics.shenba.com;&#10;&#10;        root /Users/CoderQ/shenba/code/h5statics.shenba.com;&#10;    &#125;&#10;&#10;    server &#123;&#10;        listen 80;&#10;        server_name local.dian.shenba.com;&#10;        #access_log /var/log/nginx/node_h5site.log&#10;        location / &#123;&#10;            proxy_set_header    X-Real-IP           $remote_addr;&#10;            proxy_set_header    X-Forwarded-For     $proxy_add_x_forwarded_for;&#10;            proxy_set_header    Host                $http_host;&#10;            proxy_set_header    X-NginX-Proxy       true;&#10;            proxy_set_header    Connection          &#34;&#34;;&#10;            proxy_http_version  1.1;&#10;            proxy_pass          http://localhost:3444;&#10;        &#125;&#10;    &#125;&#10;    server &#123;&#10;        listen       80;&#10;        server_name  local.dstatics.shenba.com;&#10;&#10;        root   /Users/CoderQ/shenba/code/dstatics.shenba.com;&#10;&#10;        #&#23383;&#20307;&#36328;&#22495;&#10;        location ~* \.(eot|ttf|woff|js)$ &#123;&#10;            add_header Access-Control-Allow-Origin *;&#10;        &#125;&#10;    &#125;&#10;&#10;    # another virtual host using mix of IP-, name-, and port-based configuration&#10;    #&#10;    #server &#123;&#10;    #    listen       8000;&#10;    #    listen       somename:8080;&#10;    #    server_name  somename  alias  another.alias;&#10;&#10;    #    location / &#123;&#10;    #        root   html;&#10;    #        index  index.html index.htm;&#10;    #    &#125;&#10;    #&#125;&#10;&#10;&#10;    # HTTPS server&#10;    #&#10;    #server &#123;&#10;    #    listen       443 ssl;&#10;    #    server_name  localhost;&#10;&#10;    #    ssl_certificate      cert.pem;&#10;    #    ssl_certificate_key  cert.key;&#10;&#10;    #    ssl_session_cache    shared:SSL:1m;&#10;    #    ssl_session_timeout  5m;&#10;&#10;    #    ssl_ciphers  HIGH:!aNULL:!MD5;&#10;    #    ssl_prefer_server_ciphers  on;&#10;&#10;    #    location / &#123;&#10;    #        root   html;&#10;    #        index  index.html index.htm;&#10;    #    &#125;&#10;    #&#125;&#10;&#10;&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/nginx/">nginx</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-create-openssl-certificate-for-https" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/02/create-openssl-certificate-for-https/" class="article-date">
      <time datetime="2016-03-02T11:59:33.000Z" itemprop="datePublished">2016-03-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/02/create-openssl-certificate-for-https/">通过OpenSSL创建证书文件构建https服务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>以前用node.js构建过https服务，很简单，就是把两个文件的路径放在代码里，把http协议换成https就搞定了。不过今天我收到的是一个文件夹，两个文件怎么用都报错，于是有了自己生成证书文件来证实问题出在哪里的想法。最后发现问题在于这个文件夹里全是—–BEGIN CERTIFICATE—–的文件，找不到一个—–BEGIN RSA PRIVATE KEY—–的文件。</p>
<h2 id="OpenSSL_u751F_u6210_u8BC1_u4E66"><a href="#OpenSSL_u751F_u6210_u8BC1_u4E66" class="headerlink" title="OpenSSL生成证书"></a>OpenSSL生成证书</h2><ul>
<li><p>创建openssl.cnf文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[req]  &#10;    distinguished_name = req_distinguished_name  &#10;    req_extensions = v3_req  &#10;  &#10;    [req_distinguished_name]  &#10;    countryName = Country Name (2 letter code)  &#10;    countryName_default = CN  &#10;    stateOrProvinceName = State or Province Name (full name)  &#10;    stateOrProvinceName_default = BeiJing  &#10;    localityName = Locality Name (eg, city)  &#10;    localityName_default = YaYunCun  &#10;    organizationalUnitName  = Organizational Unit Name (eg, section)  &#10;    organizationalUnitName_default  = Domain Control Validated  &#10;    commonName = Internet Widgits Ltd  &#10;    commonName_max  = 64  &#10;  &#10;    [ v3_req ]  &#10;    # Extensions to add to a certificate request  &#10;    basicConstraints = CA:FALSE  &#10;    keyUsage = nonRepudiation, digitalSignature, keyEncipherment  &#10;    subjectAltName = @alt_names  &#10;  &#10;    [alt_names]  &#10;&#9;#&#27880;&#24847;&#36825;&#20010;IP.1&#30340;&#35774;&#32622;&#65292;IP&#22320;&#22336;&#38656;&#35201;&#21644;&#20320;&#30340;&#26381;&#21153;&#22120;&#30340;&#30417;&#21548;&#22320;&#22336;&#19968;&#26679;&#10;    IP.1 = 127.0.0.1</span><br></pre></td></tr></table></figure>
</li>
<li><p>为CA生成私钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out ca-key.pem -des 1024</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过CA私钥生成CSR</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -key ca-key.pem -out ca-csr.pem</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过CSR文件和私钥生成CA证书</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -in ca-csr.pem -signkey ca-key.pem -out ca-cert.pem</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过服务器私钥文件和CSR文件生成服务器证书</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -req -CA ca-cert.pem -CAkey ca-key.pem -CAcreateserial -in server-csr.pem -out server-cert.pem -extensions v3_req -extfile openssl.cnf</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="node-js_u670D_u52A1_u7AEF"><a href="#node-js_u670D_u52A1_u7AEF" class="headerlink" title="node.js服务端"></a>node.js服务端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var https = require(&#39;https&#39;);&#10;var fs = require(&#39;fs&#39;);&#10;&#10;var options = &#123;&#10;&#9;key: fs.readFileSync(&#39;./keys/server-key.pem&#39;),&#10;&#9;// ca: [fs.readFileSync(&#39;./keys/ca-cert.pem&#39;)],&#10;&#9;cert: fs.readFileSync(&#39;./keys/server-cert.pem&#39;)&#10;&#125;;&#10;&#10;https.createServer(options,function(req,res)&#123;&#10;&#9;res.writeHead(200);&#10;&#9;res.end(&#39;hello world\n&#39;);&#10;&#125;).listen(3000,&#39;127.0.0.1&#39;);</span><br></pre></td></tr></table></figure>
<h2 id="u53C2_u8003_u6587_u732E"><a href="#u53C2_u8003_u6587_u732E" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="https://cnodejs.org/topic/54745ac22804a0997d38b32d" target="_blank" rel="external">https://cnodejs.org/topic/54745ac22804a0997d38b32d</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/ssl/">ssl</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssl/">ssl</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-decode-utf8" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/29/decode-utf8/" class="article-date">
      <time datetime="2016-02-29T00:05:06.000Z" itemprop="datePublished">2016-02-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/29/decode-utf8/">html中UTF8编码的解码</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我们写爬虫爬回来的一些页面可能是编码后的utf8码，这时候我们需要对他们进行解码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var code10, code16, zh;&#10;&#10;code10 = &#39;&#38;#22825;&#38;#22530;&#38;#21521;&#38;#24038;,&#38;#28145;&#38;#22323;&#38;#21521;&#38;#21491;&#39;;&#10;&#10;zh = code10.replace(/&#38;#(\d+);/g, function($, $1) &#123;return String.fromCodePoint($1)&#125;);&#10;&#10;console.log(zh);&#10;&#10;code16 = zh.replace(/[^\u0000-\u00ff]/g, function($) &#123;return &#39;&#38;#x&#39; + $.codePointAt(0).toString(16) + &#39;;&#39;;&#125;);&#10;&#10;console.log(code16);&#10;&#10;zh = code16.replace(/&#38;#x(\w+);/g, function($, $1) &#123;return String.fromCodePoint(parseInt($1, 16))&#125;);&#10;&#10;console.log(zh);</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/html/">html</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html/">html</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-mongodb-update-by-self-field" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/27/mongodb-update-by-self-field/" class="article-date">
      <time datetime="2016-02-27T00:09:14.000Z" itemprop="datePublished">2016-02-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/27/mongodb-update-by-self-field/">mongodb的文档如何通过自己的某些字段更新文档的方法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u4EC5_u4EC5_u6539_u53D8Key"><a href="#u4EC5_u4EC5_u6539_u53D8Key" class="headerlink" title="仅仅改变Key"></a>仅仅改变Key</h2><p>如果你的值没有问题，只是你的key出现了问题，需要修改key，可以使用$rename来做简单的处理<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init</span></span><br><span class="line">db.events.insert(&#123; <span class="string">'lat'</span>: <span class="number">1</span>, <span class="string">'lon'</span>: <span class="number">2</span>, someotherdata: [] &#125;)</span><br><span class="line">db.events.insert(&#123; <span class="string">'lat'</span>: <span class="number">4</span>, <span class="string">'lon'</span>: <span class="number">1</span>, someotherdata: [] &#125;)</span><br><span class="line"><span class="comment">// doit</span></span><br><span class="line">db.events.update(&#123;&#125;, &#123;$rename: &#123;<span class="string">'lat'</span>: <span class="string">'coords.lat'</span>, <span class="string">'lon'</span>: <span class="string">'coords.lon'</span>&#125;&#125;, <span class="literal">false</span>, <span class="literal">true</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// result</span></span><br><span class="line">db.events.find()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"5113c82dd28c4e8b79971add"</span>),</span><br><span class="line">    <span class="string">"coords"</span> : &#123;</span><br><span class="line">        <span class="string">"lat"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="string">"lon"</span> : <span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"someotherdata"</span> : [ ]</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"5113c82ed28c4e8b79971ade"</span>),</span><br><span class="line">    <span class="string">"coords"</span> : &#123;</span><br><span class="line">        <span class="string">"lat"</span> : <span class="number">4</span>,</span><br><span class="line">        <span class="string">"lon"</span> : <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"someotherdata"</span> : [ ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u4FEE_u590DKey_u548CValue"><a href="#u4FEE_u590DKey_u548CValue" class="headerlink" title="修复Key和Value"></a>修复Key和Value</h2><p>如果你的value也出现问题，那么仅仅rename是无济于事的，你可以用下面的方法来处理整个collection。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.events.find().snapshot().forEach(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// update document, using its own properties</span></span><br><span class="line">    e.coords = &#123; lat: e.lat, lon: e.lon &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remove old properties</span></span><br><span class="line">    <span class="keyword">delete</span> e.lat;</span><br><span class="line">    <span class="keyword">delete</span> e.lon;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// save the updated document</span></span><br><span class="line">    db.events.save(e);</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>查看<a href="http://stackoverflow.com/questions/3788256/mongodb-updating-documents-using-data-from-the-same-document/3792958#3792958" target="_blank" rel="external">stackoverflow</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/mongodb/">mongodb</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/">mongodb</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-javascript-merge-sort" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/22/javascript-merge-sort/" class="article-date">
      <time datetime="2016-02-21T17:12:35.000Z" itemprop="datePublished">2016-02-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/22/javascript-merge-sort/">javascript实现合并排序</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> merge = <span class="function"><span class="keyword">function</span>(<span class="params">ary, p, q, r</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// eg. ary = [4, 1], p = 0, q = 0, r = 1</span></span><br><span class="line">	<span class="keyword">var</span> l_ary = ary.slice(p, q + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">var</span> r_ary = ary.slice(q + <span class="number">1</span>, r + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">var</span> b_ary;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (l_ary.length &amp;&amp; r_ary.length) &#123;</span><br><span class="line">		ary[p++] = l_ary[<span class="number">0</span>] &lt;= r_ary[<span class="number">0</span>] ? l_ary.shift() : r_ary.shift();	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	b_ary = l_ary.length ? l_ary : r_ary;</span><br><span class="line">	<span class="keyword">while</span> (b_ary.length) &#123;</span><br><span class="line">		ary[p++] = b_ary.shift();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">console</span>.log(ary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> merge_sort = <span class="function"><span class="keyword">function</span>(<span class="params">ary, s, e</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> m;</span><br><span class="line">	<span class="keyword">if</span> (s === e) <span class="keyword">return</span>;</span><br><span class="line">	m = <span class="built_in">Math</span>.floor((s + e) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	merge_sort(ary, s, m);</span><br><span class="line">	merge_sort(ary, m + <span class="number">1</span>, e);</span><br><span class="line">	merge(ary, s, m, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> do_merge_sort = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ary = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">console</span>.log(ary);</span><br><span class="line">	merge_sort(ary, <span class="number">0</span>, ary.length - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">console</span>.log(ary);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">do_merge_sort();</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-opencv-ippicv-macosx" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/19/opencv-ippicv-macosx/" class="article-date">
      <time datetime="2016-02-18T16:12:35.000Z" itemprop="datePublished">2016-02-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/19/opencv-ippicv-macosx/">用cmake安装opencv遇到缺少ippicv-macosx-*.*文件的解决方案</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ol>
<li><p>既然出错，那么你一定可以看到报错提示，大致如下。这里面你收获了第一个关键信息<em>expected hash: [4ff1fde9a7cfdfe7250bfcd8334e0f2f]</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for file: [/Users/CoderQ/Downloads/opencv-3.1.0/3rdparty/ippicv/downloads/macosx-4ff1fde9a7cfdfe7250bfcd8334e0f2f/ippicv_macosx_20151201.tgz]&#10;  expected hash: [4ff1fde9a7cfdfe7250bfcd8334e0f2f]&#10;    actual hash: [cc09c2a46b5dd28acea8e1e78e296670]&#10;         status: [28;&#34;Timeout was reached&#34;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>上搜索引擎搜<em>4ff1fde9a7cfdfe7250bfcd8334e0f2f</em>，你会发现第一个搜索结果指向了<a href="http://code.metager.de/source/xref/lib/opencv/3rdparty/ippicv/downloader.cmake" target="_blank" rel="external">源码地址</a></p>
</li>
<li><p>代码里<em>OPENCV_ICV_PACKAGE_HASH</em>这个变量指向了<em>4ff1fde9a7cfdfe7250bfcd8334e0f2f</em>。</p>
</li>
<li><p>之后你会找到这行代码，他告诉你这个URL地址还需要另一个变量<em>OPENCV_ICV_URL</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file(DOWNLOAD &#34;$&#123;OPENCV_ICV_URL&#125;/$&#123;OPENCV_ICV_PACKAGE_NAME&#125;&#34; &#34;$&#123;OPENCV_ICV_PACKAGE_ARCHIVE&#125;&#34;</span><br></pre></td></tr></table></figure>
</li>
<li><p>之后根据源码你可以拼出这个地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://raw.githubusercontent.com/Itseez/opencv_3rdparty/81a676001ca8075ada498583e4166079e5744668/ippicv/ippicv_macosx_20151201.tgz</span><br></pre></td></tr></table></figure>
</li>
<li><p>把文件下载后放在提示的地址，重新安装。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Users/CoderQ/Downloads/opencv-3.1.0/3rdparty/ippicv/downloads/macosx-4ff1fde9a7cfdfe7250bfcd8334e0f2f/ippicv_macosx_20151201.tgz</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/opencv/">opencv</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/opencv/">opencv</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-javascript-deal-with-unicode" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/16/javascript-deal-with-unicode/" class="article-date">
      <time datetime="2016-02-16T07:52:47.000Z" itemprop="datePublished">2016-02-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/16/javascript-deal-with-unicode/">Unicode字符处理</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>最近做爬虫程序，偶尔会在返回的内容中看到一堆类似这样的东西<em>&amp;#22825;&amp;#22530;&amp;#21521;&amp;#24038;,&amp;#28145;&amp;#22323;&amp;#21521;&amp;#21491;</em>，一时间不知道怎么把它们转成中文。于是上网求救，发现解决方案后感觉so easy。其实很多东西不明白之前都很难，明白了就很简单，我是不是在说废话呢？？？</p>
<p>其实这串字符中的数字就是对应unicode字符的十进制表示方式，所以我们只要通过<em>String.fromCodePoint</em>进行简单的转化就可以得到想要的结果了。根据网友的提示，返回的内容还有可能是十六进制的，于是我自己写了个例子，备忘。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> code10, code16, zh;</span><br><span class="line"></span><br><span class="line">code10 = <span class="string">'&amp;#22825;&amp;#22530;&amp;#21521;&amp;#24038;,&amp;#28145;&amp;#22323;&amp;#21521;&amp;#21491;'</span>;</span><br><span class="line"></span><br><span class="line">zh = code10.replace(<span class="regexp">/&amp;#(\d+);/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$, $1</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">String</span>.fromCodePoint($<span class="number">1</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(zh);</span><br><span class="line"></span><br><span class="line">code16 = zh.replace(<span class="regexp">/[^\u0000-\u00ff]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">'&amp;#x'</span> + $.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>) + <span class="string">';'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(code16);</span><br><span class="line"></span><br><span class="line">zh = code16.replace(<span class="regexp">/&amp;#x(\w+);/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$, $1</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">String</span>.fromCodePoint(<span class="built_in">parseInt</span>($<span class="number">1</span>, <span class="number">16</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(zh);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-c-basic" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/14/c-basic/" class="article-date">
      <time datetime="2016-02-14T00:00:20.000Z" itemprop="datePublished">2016-02-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/14/c-basic/">C语言基础</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u6307_u9488"><a href="#u6307_u9488" class="headerlink" title="指针"></a>指针</h2><p>指针（Pointer）是编程语言中的一个对象，利用地址，它的值直接指向存在电脑存储器中另一个地方的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include &#34;stdio.h&#34;&#10;&#10;int main(int argc, char const *argv[])&#10;&#123;&#10;&#9;char* c = &#34;123&#34;; // c&#26159;&#19968;&#20010;&#25351;&#38024;&#21464;&#37327;&#65292;&#25351;&#21521;&#34;123&#34;&#36825;&#20010;&#23383;&#31526;&#20018;&#30340;&#20869;&#23384;&#22320;&#22336;&#10;&#9;printf(&#34;%s\n&#34;, c); // &#25171;&#21360;&#20986;c&#25351;&#38024;&#25351;&#21521;&#30340;&#23383;&#31526;&#20018;&#10;&#9;printf(&#34;%c\n&#34;, *c); // &#25171;&#21360;&#20986;c&#25351;&#38024;&#25351;&#21521;&#30340;&#31532;&#19968;&#20010;&#23383;&#31526;&#10;&#10;&#9;short s = 123; // &#23450;&#20041;&#19968;&#20010;&#30701;&#25972;&#24418;&#21464;&#37327;s&#10;&#9;short* p = &#38;s; // &#23450;&#20041;&#19968;&#20010;&#30701;&#25972;&#24418;&#25351;&#38024;&#65292;&#24182;&#35753;&#25351;&#38024;&#25351;&#21521;s&#25152;&#22312;&#30340;&#22320;&#22336;&#10;&#9;printf(&#34;%u\n&#34;, *p); // &#36755;&#20986;p&#25351;&#38024;&#25152;&#25351;&#21521;&#30340;&#20869;&#23384;&#24555;&#10;&#10;&#9;return 0;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>很多书籍，喜欢把*号放在变量前面，但是这容易让初学者误解，其实*放在类型后面或变量前面都是没问题的。如果加*，例如char* c，那么c就是一个指针变量，如果要取出它对应的值，必须使用*c，这样好理解很多了。如果写成char *c就容易搞不清楚定义的是个啥了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/C/">C</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-http-accept-encoding" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/06/http-accept-encoding/" class="article-date">
      <time datetime="2016-02-06T01:44:52.000Z" itemprop="datePublished">2016-02-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/06/http-accept-encoding/">Accept-Encoding</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u683C_u5F0F"><a href="#u683C_u5F0F" class="headerlink" title="格式"></a>格式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding  = &#34;Accept-Encoding&#34; &#34;:&#34;&#10;                      1#( codings [ &#34;;&#34; &#34;q&#34; &#34;=&#34; qvalue ] )&#10;codings          = ( content-coding | &#34;*&#34; )</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: compress, gzip&#10;Accept-Encoding:&#10;Accept-Encoding: *&#10;Accept-Encoding: compress;q=0.5, gzip;q=1.0&#10;Accept-Encoding: gzip;q=1.0, identity; q=0.5, *;q=0</span><br></pre></td></tr></table></figure>
<h2 id="u89C4_u5219"><a href="#u89C4_u5219" class="headerlink" title="规则"></a>规则</h2><ul>
<li>如果设置了一个编码方案，那么表明该方案是客户端可以接受的，除非设置了<em>;q=0</em></li>
<li>特殊的*标记表示客户端可以接受所有的编码方案</li>
<li>如果设置了多个编码方案，那么q值最高的方案成为首选方案</li>
<li>纵使没有设置indentify类型，indentify类型依然会被认为是客接受的，除非设置了<em>indentify;q=0</em>或者<em>\</em>;q=0*。如果没有设置Accept-Encoding，那么默认为indentify。</li>
</ul>
<h2 id="u9009_u9879"><a href="#u9009_u9879" class="headerlink" title="选项"></a>选项</h2><h3 id="indentity"><a href="#indentity" class="headerlink" title="indentity"></a>indentity</h3><p>总是可以被接受的encoding类型，Accept-Encoding默认选项。</p>
<h3 id="compress"><a href="#compress" class="headerlink" title="compress"></a>compress</h3><p>compress是一个相当古老的 unix 档案压缩指令，压缩后的档案会加上一个 .Z 延伸档名以区别未压缩的档案，压缩后的档案可以以 uncompress 解压。若要将数个档案压成一个压缩档，必须先将档案 tar 起来再压缩。由于 gzip 可以产生更理想的压缩比例，一般人多已改用 gzip 为档案压缩工具。</p>
<h3 id="deflate"><a href="#deflate" class="headerlink" title="deflate"></a>deflate</h3><p>deflate是最基础的算法，gzip在deflate的raw data前增加了10个字节的gzheader，尾部添加了8个字节的校验字节（可选crc32 和adler32）和长度标识字节。deflate是一种压缩算法,是huffman编码的一种加强。gzip是一种数据格式，默认且目前仅使用deflate算法压缩data部分。</p>
<h3 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h3><p>GZIP最早由Jean-loup Gailly和Mark Adler创建，用于UNIX系统的文件压缩。我们在Linux中经常会用到后缀为.gz的文件，它们就是GZIP格式的。现今已经成为Internet 上使用非常普遍的一种数据压缩格式，或者说一种文件格式。HTTP协议上的GZIP编码是一种用来改进WEB应用程序性能的技术。大流量的WEB站点常常使用GZIP压缩技术来让用户感受更快的速度。这一般是指WWW服务器中安装的一个功能,当有人来访问这个服务器中的网站时,服务器中的这个功能就将网页内容压缩后传输到来访的电脑浏览器中显示出来.一般对纯文本内容可压缩到原大小的40%.这样传输就快了,效果就是你点击网址后会很快的显示出来.当然这也会增加服务器的负载. 一般服务器中都安装有这个功能模块的.</p>
<p><a href="/2016/02/06/nginx-gzip/">在nginx中配置gzip</a></p>
<h2 id="u53C2_u8003_u8D44_u6599"><a href="#u53C2_u8003_u8D44_u6599" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3" target="_blank" rel="external">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3</a></li>
<li><a href="http://baike.baidu.com/link?url=xWxjsQkPTkOPD7CMnSUQCM_MTtORJ2xMxbKmaeX1WEi2MmFUjQP_JRdWMxBumkc5WO_0m-2_sPMCHhClk6U_nK" target="_blank" rel="external">http://baike.baidu.com/link?url=xWxjsQkPTkOPD7CMnSUQCM_MTtORJ2xMxbKmaeX1WEi2MmFUjQP_JRdWMxBumkc5WO_0m-2_sPMCHhClk6U_nK</a></li>
<li><a href="http://blog.csdn.net/zhangxinrun/article/details/5711307" target="_blank" rel="external">http://blog.csdn.net/zhangxinrun/article/details/5711307</a></li>
<li><a href="https://zh.wikipedia.org/wiki/DEFLATE" target="_blank" rel="external">https://zh.wikipedia.org/wiki/DEFLATE</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/HTTP-TCP-IP/">HTTP/TCP/IP</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/">http</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-http-accept" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/06/http-accept/" class="article-date">
      <time datetime="2016-02-05T23:57:52.000Z" itemprop="datePublished">2016-02-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/06/http-accept/">Accept</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u683C_u5F0F"><a href="#u683C_u5F0F" class="headerlink" title="格式"></a>格式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept         = &#34;Accept&#34; &#34;:&#34;&#10;                    #( media-range [ accept-params ] )&#10;media-range    = ( &#34;*/*&#34;&#10;                    | ( type &#34;/&#34; &#34;*&#34; )&#10;                    | ( type &#34;/&#34; subtype )&#10;                    ) *( &#34;;&#34; parameter )&#10;accept-params  = &#34;;&#34; &#34;q&#34; &#34;=&#34; qvalue *( accept-extension )&#10;accept-extension = &#34;;&#34; token [ &#34;=&#34; ( token | quoted-string ) ]</span><br></pre></td></tr></table></figure>
<ul>
<li>Accept可以接受多种类型值，多个类型值之间用逗号隔开。</li>
<li>q用于表示客户端对于某种类型的渴望程度，q的范围为0到1，q的值越高表示客户端越渴望得到这种类型的返回。q和类型值之间用分号隔开。默认值是1。小数位数不超过3位。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept: text/plain;q=0.5,text/xml;q=0.8,text/html</span><br></pre></td></tr></table></figure>
<p>以上内容表示：客户端非常希望服务器端传回html格式的内容；如果没有，xml格式也可以接受；实在连xml都没有，txt格式也可以接受。</p>
<h2 id="u5E38_u7528_u7C7B_u578B"><a href="#u5E38_u7528_u7C7B_u578B" class="headerlink" title="常用类型"></a>常用类型</h2><table>
<thead>
<tr>
<th>文件类型</th>
<th>Accept内容</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>*.*</td>
<td><em>/</em></td>
<td>不限制类型</td>
</tr>
<tr>
<td>*.html</td>
<td>text/html</td>
<td>HTML格式</td>
</tr>
<tr>
<td></td>
<td>image/*</td>
<td>所有图片</td>
</tr>
<tr>
<td>*.gif</td>
<td>image/gif</td>
<td>Graphic Interchange Format</td>
</tr>
<tr>
<td>*.jp2</td>
<td>image/jp2</td>
<td>JPEG-2000</td>
</tr>
<tr>
<td>*.jpe</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpeg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.css</td>
<td>text/css</td>
<td>Cascading Style Sheets</td>
</tr>
<tr>
<td>*.js</td>
<td>text/javascript, application/javascript</td>
<td>JavaScript</td>
</tr>
<tr>
<td>*.json</td>
<td>application/json</td>
<td>JavaScript Object Notation</td>
</tr>
<tr>
<td>*.xml</td>
<td>text/xml, application/xml</td>
<td>Extensible Markup Language</td>
</tr>
<tr>
<td>*.txt</td>
<td>text/plain</td>
<td>Plain Text</td>
</tr>
</tbody>
</table>
<h2 id="u5168_u90E8_u7C7B_u578B"><a href="#u5168_u90E8_u7C7B_u578B" class="headerlink" title="全部类型"></a>全部类型</h2><table>
<thead>
<tr>
<th>文件类型</th>
<th>Accept内容</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>*.3gpp</td>
<td>audio/3gpp, video/3gpp</td>
<td>3GPP Audio/Video</td>
</tr>
<tr>
<td>*.ac3</td>
<td>audio/ac3</td>
<td>AC3 Audio</td>
</tr>
<tr>
<td>*.asf</td>
<td>allpication/vnd.ms-asf</td>
<td>Advanced Streaming Format</td>
</tr>
<tr>
<td>*.au</td>
<td>audio/basic</td>
<td>AU Audio</td>
</tr>
<tr>
<td>*.css</td>
<td>text/css</td>
<td>Cascading Style Sheets</td>
</tr>
<tr>
<td>*.csv</td>
<td>text/csv</td>
<td>Comma Separated Values</td>
</tr>
<tr>
<td>*.doc</td>
<td>application/msword</td>
<td>MS Word Document</td>
</tr>
<tr>
<td>*.dot</td>
<td>application/msword</td>
<td>MS Word Template</td>
</tr>
<tr>
<td>*.dtd</td>
<td>application/xml-dtd</td>
<td>Document Type Definition</td>
</tr>
<tr>
<td>*.dwg</td>
<td>image/vnd.dwg</td>
<td>AutoCAD Drawing Database</td>
</tr>
<tr>
<td>*.dxf</td>
<td>image/vnd.dxf</td>
<td>AutoCAD Drawing Interchange Format</td>
</tr>
<tr>
<td>*.gif</td>
<td>image/gif</td>
<td>Graphic Interchange Format</td>
</tr>
<tr>
<td>*.htm</td>
<td>text/html</td>
<td>HyperText Markup Language</td>
</tr>
<tr>
<td>*.html</td>
<td>text/html</td>
<td>HyperText Markup Language</td>
</tr>
<tr>
<td>*.jp2</td>
<td>image/jp2</td>
<td>JPEG-2000</td>
</tr>
<tr>
<td>*.jpe</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpeg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.js</td>
<td>text/javascript, application/javascript</td>
<td>JavaScript</td>
</tr>
<tr>
<td>*.json</td>
<td>application/json</td>
<td>JavaScript Object Notation</td>
</tr>
<tr>
<td>*.mp2</td>
<td>audio/mpeg, video/mpeg</td>
<td>MPEG Audio/Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mp3</td>
<td>audio/mpeg</td>
<td>MPEG Audio Stream, Layer III</td>
</tr>
<tr>
<td>*.mp4</td>
<td>audio/mp4, video/mp4</td>
<td>MPEG-4 Audio/Video</td>
</tr>
<tr>
<td>*.mpeg</td>
<td>video/mpeg</td>
<td>MPEG Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mpg</td>
<td>video/mpeg</td>
<td>MPEG Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mpp</td>
<td>application/vnd.ms-project</td>
<td>MS Project Project</td>
</tr>
<tr>
<td>*.ogg</td>
<td>application/ogg, audio/ogg</td>
<td>Ogg Vorbis</td>
</tr>
<tr>
<td>*.pdf</td>
<td>application/pdf</td>
<td>Portable Document Format</td>
</tr>
<tr>
<td>*.png</td>
<td>image/png</td>
<td>Portable Network Graphics</td>
</tr>
<tr>
<td>*.pot</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Template</td>
</tr>
<tr>
<td>*.pps</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Slideshow</td>
</tr>
<tr>
<td>*.ppt</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Presentation</td>
</tr>
<tr>
<td>*.rtf</td>
<td>application/rtf, text/rtf</td>
<td>Rich Text Format</td>
</tr>
<tr>
<td>*.svf</td>
<td>image/vnd.svf</td>
<td>Simple Vector Format</td>
</tr>
<tr>
<td>*.tif</td>
<td>image/tiff</td>
<td>Tagged Image Format File</td>
</tr>
<tr>
<td>*.tiff</td>
<td>image/tiff</td>
<td>Tagged Image Format File</td>
</tr>
<tr>
<td>*.txt</td>
<td>text/plain</td>
<td>Plain Text</td>
</tr>
<tr>
<td>*.wdb</td>
<td>application/vnd.ms-works</td>
<td>MS Works Database</td>
</tr>
<tr>
<td>*.wps</td>
<td>application/vnd.ms-works</td>
<td>Works Text Document</td>
</tr>
<tr>
<td>*.xhtml</td>
<td>application/xhtml+xml</td>
<td>Extensible HyperText Markup Language</td>
</tr>
<tr>
<td>*.xlc</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Chart</td>
</tr>
<tr>
<td>*.xlm</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Macro</td>
</tr>
<tr>
<td>*.xls</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Spreadsheet</td>
</tr>
<tr>
<td>*.xlt</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Template</td>
</tr>
<tr>
<td>*.xlw</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Workspace</td>
</tr>
<tr>
<td>*.xml</td>
<td>text/xml, application/xml</td>
<td>Extensible Markup Language</td>
</tr>
<tr>
<td>*.zip</td>
<td>aplication/zip</td>
<td>Compressed Archive</td>
</tr>
</tbody>
</table>
<h2 id="u53C2_u8003_u8D44_u6599"><a href="#u53C2_u8003_u8D44_u6599" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1" target="_blank" rel="external">https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1</a></li>
<li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.9" target="_blank" rel="external">https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.9</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_866e403f010179f1.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_866e403f010179f1.html</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/HTTP-TCP-IP/">HTTP/TCP/IP</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/">http</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 CoderQ
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本站到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>